{{ define "main" }}
<section class="hero">
  <h1>{{ .Site.Title }}</h1>
  <p class="tagline">{{ .Site.Params.tagline }}</p>
</section>

<!-- Recent Blog Posts -->
{{ $posts := (where .Site.RegularPages "Section" "blog").ByDate.Reverse }}
{{ if $posts }}
<section>
  <div class="section-header">
    <h2>// recent posts</h2>
  </div>
  <ul class="post-list">
    {{ range first 10 $posts }}
    <li class="post-item">
      <div class="post-meta">{{ .Date.Format "2006-01-02" }}</div>
      <h3 class="post-title"><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
      {{ with .Summary }}<p class="post-excerpt">{{ . }}</p>{{ end }}
    </li>
    {{ end }}
  </ul>
  {{ if gt (len $posts) 10 }}
  <a href="/blog/" class="more-button">MORE POSTS →</a>
  {{ end }}
</section>
{{ end }}

<!-- Recent CVEs -->
{{ $cves := where .Site.RegularPages "Section" "cves" }}
{{ if $cves }}
<section style="margin-top: 3rem;">
  <div class="section-header">
    <h2>// vulnerability research</h2>
    <a href="/cves/" class="view-all">view all →</a>
  </div>
  <ul class="post-list">
    {{ range first 3 $cves }}
    <li class="post-item">
      <div class="post-meta">
        {{ .Date.Format "2006-01-02" }}
        {{ with .Params.cve }} · <strong>{{ . }}</strong>{{ end }}
      </div>
      <h3 class="post-title"><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
      {{ with .Summary }}<p class="post-excerpt">{{ . }}</p>{{ end }}
      <div class="tags">
        {{ with .Params.severity }}<span class="tag severity-{{ lower . }}">{{ . }}</span>{{ end }}
        {{ range .Params.tags }}<span class="tag">{{ . }}</span>{{ end }}
      </div>
    </li>
    {{ end }}
  </ul>
</section>
{{ end }}

<!-- Tools -->
{{ $tools := where .Site.RegularPages "Section" "tools" }}
{{ if $tools }}
<section style="margin-top: 3rem;">
  <div class="section-header">
    <h2>// tools</h2>
    <a href="/tools/" class="view-all">view all →</a>
  </div>
  {{ range first 2 $tools }}
  <div class="tool-card">
    <h3><a href="{{ .Permalink }}">{{ .Title }}</a></h3>
    {{ with .Summary }}<p>{{ . }}</p>{{ end }}
    <div class="tool-links">
      {{ with .Params.github }}<a href="{{ . }}">GitHub →</a>{{ end }}
      {{ with .Params.docs }}<a href="{{ . }}">Docs →</a>{{ end }}
    </div>
  </div>
  {{ end }}
</section>
{{ end }}
{{ end }}
